---
import { getCollection, getEntry, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import OrganizerCard from "../../components/OrganizerCard.astro";
import GuestTag from "../../components/GuestTag.astro";

export async function getStaticPaths() {
  const workshops = await getCollection("workshops");
  return workshops.map((workshop) => ({
    params: { id: workshop.id },
    props: { workshop },
  }));
}

const { workshop } = Astro.props;
const entry = await getEntry("workshops", workshop.id);
if (!entry) {
  throw new Error(`Workshop not found: ${workshop.id}`);
}
const { Content } = await render(entry);
---

<Layout title={workshop.data.title}>
  <section class="flex flex-col gap-2 md:gap-4">
    <h1 class="text-4xl font-bold my-8 flex items-center">
      {workshop.data.isGuest && <GuestTag className="text-xl font-medium me-2 px-2.5 py-1.5" />}
      {workshop.data.title}
    </h1>
    <div class="prose w-full max-w-none">
      <Content />
    </div>
    <h2 class="text-xl font-bold my-4">オーガナイザー</h2>
    <OrganizerCard
      name={workshop.data.organizer.name}
      icon={workshop.data.organizer.icon}
      organization={workshop.data.organizer.organization}
      profile={workshop.data.organizer.profile}
    />
  </section>
</Layout>
